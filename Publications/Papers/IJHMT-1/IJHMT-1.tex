\documentclass[preprint,12pt]{elsarticle}
\biboptions{sort&compress}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{tabls}
\usepackage{multirow}
\usepackage{cleveref}
\usepackage{verbatim}

\usepackage{pgfplots}
\usetikzlibrary{plotmarks}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\newcommand*{\h}{\hspace{5pt}}% for indentation
\newcommand*{\hh}{\h\h}% double indentation

\usepackage{framed} % Framing content
\usepackage{multicol} % Multiple columns environment
\usepackage{nomencl} % Nomenclature package
\RequirePackage{ifthen}
\renewcommand{\nomgroup}[1]{%
\ifthenelse{\equal{#1}{P}}{\item[\textbf{Superscripts}]}{
\ifthenelse{\equal{#1}{G}}{\item[\textbf{Greek Symbols}]}{
\ifthenelse{\equal{#1}{S}}{\item[\textbf{Subscripts}]}{}}}}

\newcommand{\nomunit}[1]{%
\renewcommand{\nomentryend}{\hspace*{\fill}#1}}

%\usepackage{breqn}

%\special{papersize=8.5in,11in}

\journal{International Journal of Heat and Mass Transfer}


\pdfinfo{%
  /Title    (Solution of an Inverse Convection Problem by a Predictor-Corrector Approach)
  /Author   (Yogesh Jaluria)
    /Author   (Joseph R VanderVeer)
  /Creator  (Joseph R VanderVeer)
  /Subject  (Inverse Convection Problems)
}

\begin{document}

\begin{frontmatter}
\title{Solution of an Inverse Convection Problem by a Predictor-Corrector Approach}

\author{Joseph R VanderVeer}
\author{Yogesh Jaluria\corref{cor}}
\ead{jaluria@soemail.rutgers.edu}

\address{Department of Mechanical and Aerospace Engineering: Rutgers University, 98 Brett Rd, Piscataway NJ, 08854}
\cortext[cor]{Corresponding Author}



\begin{abstract}
A predictor - corrector method for solving inverse convection problems has been developed and tested against both numerical and experimental data.  The method was applied to the simple convection problem of a two-dimensional plume in a crossflow.  Crossflow velocities up to $1.0\, m/s$.  The plume was generated by electrically heating a copper plate to a temperature up to $425\, K$.  The method attempts to predict both the source strength, and the source location, with a self imposed requirement on sampling and simulation data points.  The samples and simulations required are found to be 5 and 2 respectively.  Tests based on simulation alone indicate the methodology has a source strength prediction error of less than $1\%$ , and less than $6\%$ for source location.  Experimental tests bring the overall error upto $5\%$ for source strength and $10\%$ for source location.  This study indicates the potential of the methodology and demonstrates some of its limitations.  The approach can be extended to applied areas such as environmental flows, room fires, and thermal management systems.

\end{abstract}
\begin{keyword}
Inverse Problems \sep Computational Heat Transfer \sep Convection
\end{keyword}
\end{frontmatter}

\crefname{equation}{equation}{equations}
\crefname{figure}{figure}{figures}
\crefname{table}{table}{tables}

\newlength\figureheight 
\newlength\figurewidth 
	
	
	
	
\makenomenclature
\setlength{\nomitemsep}{-\parskip} % Baseline skip between items
\renewcommand*\nompreamble{\begin{multicols}{2}}
\renewcommand*\nompostamble{\end{multicols}}

\nomenclature[G]{$\rho$}{density}
\nomenclature[A]{$t$}{time}
\nomenclature[A]{$x,y$}{coordinates}
\nomenclature[A]{$u,v$}{velocity components}
\nomenclature[A]{$U$}{free stream velocity}
\nomenclature[A]{$P$}{pressure}
\nomenclature[A]{$E$}{thermal energy}
\nomenclature[A]{$T$}{temperature}
\nomenclature[G]{$\mu_{t}$}{eddy viscosity}
\nomenclature[A]{$P_{rt}$}{turbulent Prandtl number}
\nomenclature[A]{$k$}{turbulence kinetic energy}
\nomenclature[G]{$\epsilon$}{turbulence dissipation rate}
\nomenclature[A]{$C_1,C_2,C_{1\epsilon},C_{\mu},\sigma_k,\sigma_{\epsilon}$}{$k-\epsilon$ model coefficients}
\nomenclature[A]{$l$}{turbulence length scale}
\nomenclature[A]{$I$}{turbulence intensity}
\nomenclature[A]{$X,Y$}{normalized coordinates}
\nomenclature[A]{$n$}{number of sample locations}
\nomenclature[A]{$d$}{number of simulations}
\nomenclature[G]{$\phi$}{normalized temperature $\phi = \frac{T-T_{\infty}}{T_S-T_{\infty}}$}
\nomenclature[S]{$i, j,k$}{index}
\nomenclature[S]{$A,B$}{data set A,B}
\nomenclature[S]{$P$}{predicted}
\nomenclature[S]{$mod$}{modified}
\nomenclature[S]{$\infty$}{free stream}
\nomenclature[P]{$\ast$}{predictor stage, alternative heat flux eqn.}
\nomenclature[S]{$S$}{source}
\nomenclature[G]{$\lambda$}{thermal conductivity}
\nomenclature[A]{$F$}{minimization function}
\nomenclature[A]{$M_W$}{molecular weight}
\nomenclature[A]{$b,m$}{model parameters}
\nomenclature[G]{$\mu$}{dynamic viscosity}
\nomenclature[P]{$'$}{instantaneous}
\nomenclature[P]{$-$}{ensemble averaged}
\nomenclature[A]{ }{ }

\begin{table*}[!t]
  \begin{framed}
    \printnomenclature
  \end{framed}
\end{table*}

\section{Introduction}

Inverse heat transfer problems are often of greater interest to engineers than the associated forward problems.  An example of this consideration is the temperature distribution on the wall of an optical fiber drawing furnace.  The temperature at the center of the furnace is relatively easy to measure using an instrumented graphite rod.  The temperature at the walls of the furnace is very difficult to measure due to the cylindrical shape of the furnace, inaccessibility, and high temperatures.  \citet{issa} developed a regularization technique to use the center line temperature to predict the furnace wall temperature.  Thus an inverse problem was solved and optimization was used to make the final result essentially unique.


Many methods are available to solve inverse problems.  Several books \cite{tikhonov, tikhonov2, ozisik, orlande} and articles \cite{invconduction,invradiation,jones,daun,mossi,erturk} have been published on the subject.  However few articles cover the inverse convection problems, and those that do often cover it as an aside to radiative or conduction problems.  Of the few articles available, often a simple yet effective method is used to solve the inverse convection problem.  That method is to iterate the simulation until it matches the known data, often requiring many iterations.  This would be time consuming in large and complicated domains.  One such example is the paper by \citet{liu}, in which they use inverse convection methods to determine thermal profiles in a slot vented enclosure.  They use this iterative approach requiring 20 to 30 iterations to achieve less than $1\%$ error.  

\citet{knight} used an iterative experimental-numerical data driven approach, coupled with a response surface, to predict the temperature and velocity of a jet in a crosswind.  This method helps in predicting which data points need to be sampled in between iterations.  They found that the methodology was able to predict jet velocity within experimental uncertainty and source temperature within $9\%$.  However, the second stage of their approach over-predicted source temperature by as much as $23\%$ \cite{knight,rossmann}.

The present study is a continuation of the work initiated by \citet{knight} and \citet{rossmann}.  Preliminary work was covered in \cite{cht12}, with the sole purpose of being able to predict the source location as well as source strength.  The added complexity of the unknown source location warranted an overall simplification of the problem from a jet in a crosswind to a plume in a crosswind.  The overall goal is to predict, within acceptable error, both the location and source strength of the plume.  For this methodology to be most useful, the number of sample points must be limited to a select few, and the number of simulations also must be kept small.

\section{Experimental System}
Most inverse solution methodologies require a fundamental understanding of the forward problem.  This particular method is no different.  As previously described, the forward problem is a plume of heated air in a crosswind.  A small region heated to a given temperature $T_S$ is subjected to a flow of velocity $U_\infty$, which is perpendicular to the direction of the vertical flow induced by thermal buoyancy.

The wind tunnel test section dimensions are $54.5\times 305\times 254\, mm$, and can produce velocities in the range of $0-5.0\, m/s$.  \Cref{fig:diagram} is a schematic of the experimental wind tunnel including the computational domain.  All dimensions are in millimeters and the depth into the page is $305\, mm$.  The heated section uses a resistance type electric heater to heat a copper block, encouraging a uniform heated surface, which is $25.4\, mm$ wide.  The maximum temperature of the heated section is limited to a maximum of $450\, K$ due to material limitations of the wind tunnel.  This creates a limitation to the maximum free stream velocity within the tunnel as the maximum heat input gets overwhelmed by the free stream above $1.0\, m/s$.  That is to say the thermal plume is difficult to detect using the methods described here.  The temperatures are measured using a K-type thermocouple mounted on a two-dimensional stage for motion within the plane of the figure.  The X-direction is in the direction of the free stream, with zero at the upstream edge of the heated block.  The Y-direction is in the direction of the plume, with zero at the surface of the heater.  

A Pitot-static tube is used to determine the free stream velocity.  The tube is attached to a NIST traceable differential pressure sensor from Omega (PX655-0.1DI), which has a full scale reading of $0.1$ inches of water.  The pressure sensor has an error of $0.05\%$ of full scale reading.  This results in a maximum of $3\%$ error of the calculated velocity, which is at most $0.018\, m/s$ for the applicable velocities.

The temperature is measured using a K-type thermocouple probe mounted on an X-Y traversing stage, and recorded using a National Instruments data acquisition board.  Samples over several days yield a maximum difference of $7\%$ outside the plume, and a maximum of $2\%$ within the plume, indicating good repeatability.


\begin{figure*}[!tbp]
\begin{center}
\includegraphics[scale=.30]{WindTunnel.jpg}
\caption{Schematics of the wind tunnel and the computational domain \cite{cht12}}
\label{fig:diagram}
\end{center}
\end{figure*}

\section{Numerical Simulations}

The numerical simulations were carried out using the software package Ansys Fluent version 13\cite{fluentsoftware}.  The Navier-Stokes equations were solved using a three dimensional, steady state, realizable $k-\epsilon$ model with enhanced wall effects.  The three-dimensional model is employed due to a limitation of Fluent, solid-solid conduction is not modeled at all in two-dimensional conjugate heat transfer problems, and the desire to ensure two dimensionality of the flow.  The flow is relatively slow and often in the transient transitional turbulence regime with oscillating characteristics.  The Reynolds number is of order 2000.  The Richardson number was calculated and found to be of the order 5 and thus buoyancy introduces a non-negligible amount of turbulence into the flow.



The governing equations are given as:

\begin{equation}
\centering
u_i = \overline{u_i} + u^{'}_{i}
\label{eq:veldecomp}
\end{equation}

\begin{equation}
\frac{\partial \rho }{\partial t } + \frac{\partial }{\partial x_i} \left( \rho u_i \right) = 0 
\label{eq:mass}
\end{equation}

\begin{equation}
\centering
\begin{split}
\frac{\partial }{\partial t} \left( \rho u_i \right) &+ \frac{\partial }{\partial x_j } \left( \rho u_i u_j \right) = \\
 &\frac{\partial P}{\partial x_i } + \frac{\partial }{\partial x_j } \left[ \mu \left( 2 S_{ij} - \frac{2}{3} \delta_{ij} \frac{\partial u_k }{\partial x_k } \right) - \rho \overline{u^{'}_{i} u^{'}_{j}} \right] 
\label{eq:momentum}
\end{split}
\end{equation}

\begin{equation}
\centering
\begin{split}
\frac{\partial }{\partial t } \left( \rho E \right) &+ \frac{\partial }{\partial x_i} \left[ u_i \left( \rho E + P \right) \right] = \\
 &\frac{\partial }{\partial x_i } \left[ \left( \lambda + \frac{C_p \mu_t }{P_{rt}} \right) \frac{\partial T}{\partial x_i} \right] 
\label{eq:energy}
\end{split}
\end{equation}

\begin{equation}
\centering
\begin{split}
\frac{\partial }{\partial t} \left(\rho k \right) &+ \frac{\partial }{\partial x_j} \left( \rho k u_j \right) = \\
&\frac{\partial }{\partial x_j} \left[ \left( \mu + \frac{\mu_t}{\sigma_k} \right) \frac{\partial k}{\partial x_j} \right] + \frac{\partial u_j}{\partial x_i} \left( -\rho \overline{u^{'}_{i} u^{'}_{j}} \right) \\
&- g_i \frac{\mu_t}{\rho P_{rt}} \frac{\partial \rho }{\partial x_i} + \rho \epsilon
\label{eq:k}
\end{split}
\end{equation}

\begin{equation}
\centering
\begin{split}
 \frac{\partial }{\partial t} \left(\rho \epsilon \right) &+ \frac{\partial }{\partial x_j} \left( \rho \epsilon u_j \right) = \\
 &\frac{\partial }{\partial x_j } \left[ \left( \mu + \frac{\mu_t }{\sigma_\epsilon } \right) \frac{\partial \epsilon }{\partial x_j } \right] + \rho C_1 S \epsilon - \rho C_2 \frac{\epsilon^2 }{k+\sqrt{\nu \epsilon}} \\
 &- C_{1 \epsilon} \frac{\epsilon}{k} C_{3\epsilon} g_i \frac{\mu_t}{\rho P_{rt}} \frac{\partial \rho}{\partial x_i}
\label{eq:e}
\end{split}
\end{equation}

\begin{equation}
\centering
- \rho \overline{u^{'}_{i} u^{'}_{j}} = 2\mu_t S_{ij} - \frac{2}{3} \delta_{ij} \left( \rho k + \mu_t \frac{\partial u_k}{\partial x_k} \right)
\label{eq:reynoldsstress}
\end{equation}

\Cref{eq:veldecomp} gives the averaging employed.  \Cref{eq:mass,eq:momentum,eq:energy} are the equations for conservation of mass, momentum, and energy, respectively.  \Cref{eq:k,eq:e} are the turbulent kinetic energy and dissipation equations.  \Cref{eq:reynoldsstress} is the Reynolds stress equation.  $\delta_{ij}$ is the kronecker delta.

The constants for the turbulence model are \cite{realizable} : 
\begin{equation}
\label{eq:constants}
C_{1\epsilon} = 1.44 , C_2 = 1.9 , \sigma_k = 1.0 , \sigma_\epsilon = 1.2 , P_{rt} = 0.85 
\end{equation}
%
The coefficients of the model are \cite{fluent}:
\begin{equation}
C_1 = max\left[0.43,\frac{Sk/\epsilon}{Sk/\epsilon +5} \right] , S = \sqrt{2S_{ij}S_{ji}} , C_{3\epsilon} = tanh\left(\frac{u_g}{u_p}\right)
\end{equation}
%
Where the $u_g$ is the velocity component parallel to gravity, and $u_p$ is the velocity perpendicular to gravity.  

The realizable $k-\epsilon$ model varies from the traditional model by using a non-constant coefficient $C_\mu$ of the eddy viscosity equation $\mu_t$.  Which is defined as follows \cite{fluent,realizable}
%
\begin{subequations}
\begin{align}
\mu_t &= \frac{\rho C_{\mu} k^2}{\epsilon} \\
C_{\mu} &= \frac{1}{A_0 + \frac{A_1 k U^*}{\epsilon}} \\
U^* &\equiv \sqrt{S_{ij} S_{ji} + \Omega_{ij} \Omega_{ji}} \\
A_0 &= 4.04 \\
A_1 &= \sqrt{6} cos \left[\frac{1}{3} cos^{-1}\left(\sqrt{6} \frac{S_{ij}S_{jk}S_{ki}}{\left(S_{ij} S_{ji} \right)^{\frac{3}{2}}} \right) \right] \\
S_{ij} &= \frac{1}{2} \left( \frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right) \\
\Omega_{ij} &= \frac{1}{2} \left( \frac{\partial u_i}{\partial x_j} - \frac{\partial u_j}{\partial x_i} \right)
\end{align}
\end{subequations}
%
$S_{ij}$ and $\Omega_{ij}$ are the strain rate tensor and the angular velocity tensor respectively.  The fluid is modeled as an ideal gas at atmospheric pressure.  Specific heat at constant pressure is taken as constant at $C_P=1006.43\, J/(kg-K)$.  The dynamic viscosity and thermal conductivity are both modeled using the Chapman-Enscog equations, listed below, with constant Lennard-Jones parameters of $\sigma = 3.711\,\textup{\AA}$ and $\frac{\epsilon}{k_B} = 78.6\, K$.  Where $\Omega_{\mu}$ is the collision integral for viscosity, for more information see \citet{vincenti,fluent}.
\begin{subequations}
\begin{align}
\mu &= 2.67 \times 10^{-6} \frac{\sqrt{M_W T}}{\sigma^2 \Omega_{\mu} \left(\frac{T}{\epsilon/k_B} \right)} \\
\lambda &= \mu \left(\frac{5}{4} \frac{R}{M_W} +C_P \right)
\end{align}
\end{subequations}


The inflow boundary conditions are:
\begin{subequations}
\label{eq:inflow}
\begin{align}
u&=U_\infty , v=0 , T=T_\infty , P = P_\infty , l=4 mm , I=5\%\\
k&=\frac{3}{2}\left(U_\infty I\right)^2 \\
\epsilon &=C_{\mu}^{3/4} \frac{k^{3/2}}{l}
\end{align}
\end{subequations}
%
The boundary conditions imposed are as follows:  Since upper boundary is very far from the plume flow and should have negligible effect on the result, a symmetric boundary was used.  This would reduce the errors possibly introduced by the experimentally accurate no-slip condition.  The exit is a pressure outflow set to $P_{\infty}$.  The bottom boundary has seven zones as described in \cref{fig:diagram}, from left to right: acrylic, ceramic, heated copper, ceramic, unheated copper, ceramic, and acrylic.  All of the material properties are taken as constant.  The ceramic is a ceramic/aero-gel that has effective density, specific heat, and thermal conductivity of $2330\, kg/m^3$, $1138 \, J/(kg-K)$, and $0.1\, W/(m-K)$, respectively.  The density was calculated from the unaccounted mass of the mould used to cast the ceramic and the filled volume of said mould.  The specific heat is that of the ceramic obtained from the manufacturer, Coitronics.  The thermal conductivity was determined via approximation between the ceramic and the aero-gel wrapping.

The bottom is simulated with conjugate heat transfer, with an effective layer width of $25.4\, mm$ and an effective outer temperature of $T_{\infty}$.  The outer layer temperature for the heated copper region is taken as $T_S$ \cite{cht12}.

\subsection{Simulation Validation}

Grid independence is demonstrated with a comparison of the simulated temperature at a few locations, with varying element counts.  \Cref{tab:grid}, shows the results for the conditions tested.  The result is a variation of a fraction of a percent.  With the wide range of element count, and little change in the result, one must come to the conclusion that the result is independent of the grid.  The grid employed is an unstructured hexagonal mesh with emphasis located at the bottom surface of the wind tunnel and down stream of the plume.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ c c c c c }
 Location (x,y) (mm) & 30,2 & 35,3 & 40,1 & 50,10 \\ \hline \hline
 Element Count & \\ \hline
 67399  & 360.3 & 338.5 & 352.9 & 295.6 \\ \hline
 94378  & 360.2 & 338.6 & 352.7 & 295.6 \\ \hline
 130292 & 360.2 & 338.5 & 352.7 & 295.6 \\ \hline
 153290 & 360.1 & 338.8 & 352.6 & 295.8 \\ \hline
\end{tabular}
\caption{Grid Independence Study \cite{cht12}}
\label{tab:grid}
\end{center}
\end{table}
%
The simulation and experimental conditions of the previous table and the following two graphs are shown in here, \cref{tab:VT}.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ c c }
Parameter    & Value \\ \hline
$U_{\infty} \, (m/s)$ & $0.6\pm0.15$ \\
$T_{\infty} \, (K) $ & $294.5\pm2.0$ \\
$P_{\infty} \, (kPa) $ & $101.6\pm0.2$ \\
$T_{S} \, (K) $ & $433\pm2.0$ \\
\end{tabular}
\caption{Validation Test \cite{cht12}}
\label{tab:VT}
\end{center}
\end{table}

To validate the simulation, a comparison directly with the experimental results was performed.  Two slices of the compared data are shown in \cref{fig:simVSexpX40,fig:simVSexpX70}.  The data has been normalized via \cref{eq:normalize}, where L is the width of the heated region.  The trend in the numerical simulations tends to overshoot the experimental results, albeit the overshoot is minor.  The error within the region of interest where the bulk of the plume resides, is less than $2\%$, and often even less than $1\%$.  Having the numerical simulations match the experimental results so closely is key to allowing the following methodology to function as well as it does.

\begin{figure}[!htbp]
	\centering
  \setlength\figureheight{6cm} 
	\setlength\figurewidth{6cm}
	\input{simVSexpX40mm.tikz}
	\caption{Validation of the simulation: Experiment versus simulation at $X=1.6$}
	\label{fig:simVSexpX40}
\end{figure}
\begin{figure}[!htbp]
	\centering
	\setlength\figureheight{6cm} 
	\setlength\figurewidth{6cm}
	\input{simVSexpX70mm.tikz}
	\caption{Validation of the simulation: Experiment versus simulation at $X=2.25$}
	\label{fig:simVSexpX70}
\end{figure}

\begin{subequations}
\label{eq:normalize}
\begin{align}
\phi &= \frac{T-T_{\infty}}{T_S-T_{\infty}} \\
X &= \frac{x}{L} \\
Y &= \frac{y}{L} 
\end{align}
\end{subequations}




\section{Methodology}
If we can neglect variations in density and buoyancy effects, the energy equation is decoupled from mass and momentum.  In neglecting variations in density and thermal buoyancy, the relation between the source temperature and the local static temperature becomes linear if thermal radiation is negligible, as shown in \cref{eq:linear,eq:m,eq:b}, where the subscripts $A$ and $B$ denote different simulations,  i.e. $T_{SA}$ is the source temperature of simulation A, and $T_A\left( x,y \right)$ is the local static temperature at $x,y$ for simulation A.

\begin{subequations}
\label{eq:linearset}
\begin{align}
T_S &= m\left( x,y \right) T\left( x,y \right) + b\left( x,y \right) \label{eq:linear} \\
m\left( x,y \right) &= \frac{T_{SA} - T_{SB}}{T_A \left( x,y \right) - T_B\left( x,y \right)} \label{eq:m} \\
b\left( x,y \right) &= T_{SA} - m\left( x,y \right) T_A \left( x,y \right) \label{eq:b}
\end{align}
\end{subequations}

This simple relation proves to be accurate for the conditions of interest and given experimental accuracy, for $U_{\infty}=0\rightarrow 1 \, m/s$ and $T_S=350\rightarrow 450 \, K$.  A similar relation regarding heat flux and local static temperature can also be made, as given below.

\begin{subequations}
\label{eq:linearset2}
\begin{align}
q''_{S} &= m^{\ast}\left( x,y \right) T\left( x,y \right) + b^{\ast}\left( x,y \right) \label{eq:linear2} \\
m^{\ast}\left( x,y \right) &= \frac{q''_{SA} - q''_{SB}}{T_A \left( x,y \right) - T_B\left( x,y \right)} \label{eq:m2} \\
b^{\ast}\left( x,y \right) &= q''_{SA} - m^{\ast}\left( x,y \right) T_A \left( x,y \right) \label{eq:b2}
\end{align}
\end{subequations}

\Cref{fig:SATemp} shows the constant source temperature versus the local static temperature at $x=50\, mm,\, y=4\, mm$ for five different free stream velocities.  A linear curve fit is also plotted for each velocity.  \Cref{fig:SAFlux} is a very similar plot, showing constant source heat flux versus local static temperature, again at $x=50\, mm,\, y=4\, mm$ and for five different free stream velocities.  Clearly, the linear dependence of the temperature on the source strength is indicated.

\begin{figure}[!htbp]
	\centering
	\setlength\figureheight{6cm} 
	\setlength\figurewidth{6cm}
	\input{satemp.tikz}
	\caption{Sensitivity analysis: Constant source temperature vs local static temperature at $x=50\, mm,\, y=4\, mm$}
	\label{fig:SATemp}
\end{figure}


\begin{figure}[!htbp]
	\centering
	\setlength\figureheight{6cm} 
	\setlength\figurewidth{6cm}
	\input{saflux.tikz}
	\caption{Sensitivity analysis: Constant source heat flux vs local static temperature at $x=50\, mm,\, y=4\, mm$}
	\label{fig:SAFlux}
\end{figure}

Since the methodology for the two source boundary conditions is nearly identical, except that described within \cref{eq:linearset,eq:linearset2}, for brevity and clarity, we will only discuss constant source temperature in the subsequent results.  Note that $m$ and $m^{\ast}$ have different units, and $b$ and $b^{\ast}$ will also have different units.  This poses no problems and only used to retain dimensionally accurate results.

For the predictor and corrector steps of the method to function correctly, two sets of sample points and their locations with respect to a datum point need to be known.  That is to say $\Delta x_i$ and $\Delta y_i$ from \cref{eq:datum} are needed for all data points.  $x_1$ and $y_1$ is the location of the datum point with respect to the source.  The datum point is selected arbitrarily as part of the minimization of error, described shortly.  Empirical work has shown effective data sampling to be the datum plus two points located horizontally at $1\, mm$ spacing for the predictor step.  For the corrector step, datum plus two points located vertically at $1\, mm$ spacing are used.

\begin{subequations}
\label{eq:datum}
\begin{align}
x_i &= x_1 + \Delta x_i \\
y_i &= y_1 + \Delta y_i
\end{align}
\end{subequations}

If the functions $m\left( x,y \right)$ and $b\left( x,y \right)$ have their first derivatives significantly larger in magnitude than that of the error/ accuracy of the system, then it is possible that a very small unique region of the domain will satisfy the inverse problem.  That is to say that the global minimum of $F\left( x,y \right)$ of \cref{eq:F} will be within acceptable error of the solution.  As the first derivatives become of the same order of the error of the system the region that satisfies the inverse problem becomes unacceptably large.  This region could encompass the entire domain of the problem.  This can be easily demonstrated by allowing the datum to move a small amount.  If the resulting change in calculated temperature is very small than the new location is also a valid solution of the inverse problem, within error.  Since a unique solution is desired, the larger the change in temperature for a given displacement the smaller the range of acceptable solutions.  The effective $m\left( x,y \right)$ and $-b\left( x,y \right)$ are plotted in \cref{fig:mVSxy,fig:bVSxy}, respectively.  The function $b$ is plotted as $-b$, so a semi-log plot may be used for clarity.

The minimization of $F\left( x,y \right)$ is performed via a genetic algorithm.  The genetic algorithm is from the Mathworks Matlab\cite{matlabsoftware} optimization toolkit, using the following options shown in \cref{tab:gaparam}.  All other parameters were kept at their defaults.  This method is faster than a brute force search scheme , and substantially less prone to finding local minima than traditional algebraic search methods.  Unfortunately, the genetic algorithm is a stochastic algorithm and introduces its own small random error into the method.  Due to the nature of stochastic algorithms repeated executions of identical starting conditions will have slightly varying results \cite{onwubiko}.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l c}
\hline
Parameter & Value \\ \hline
MutationFcn & m, \@ mutationadaptfeasible \\
HybridFcn & {@fmincon, hybridopt} \\
PopulationSize & 500 \\
Generations & 1000 \\
 \end{tabular}
 \end{center}
\caption{Genetic algorithm parameters}
\label{tab:gaparam}
\end{table}

\begin{equation}
\centering
\begin{split}
F\left( x,y \right) =  \sum^{n}_{i=2} [ &m\left( x+\Delta x_i, y+\Delta y_i \right) T\left( x_i,y_i\right) \\ 
 & +b\left( x+\Delta x_i, y+\Delta y_i \right) \\ 
 &-m\left( x,y\right) T\left( x_1,y_1 \right) - b\left( x,y \right) ]^2  
\label{eq:F}
\end{split}
\end{equation}

\begin{figure}[!htbp]
	\centering
	\setlength\figureheight{6cm} 
	\setlength\figurewidth{6cm}
	\input{mVSxy.tikz}
	\caption{Function $m(X,Y)$ along the stream-wise direction, for $T_S = 425\, K$, $U_{\infty}=0.6\, m/s$}
	\label{fig:mVSxy}
\end{figure}
\begin{figure}[!htbp]
	\centering
	\setlength\figureheight{6cm} 
	\setlength\figurewidth{6cm}
	\input{bVSxy.tikz}
	\caption{$Function -b(X,Y)$ along the stream-wise direction, for $T_S = 425\, K$, $U_{\infty}=0.6\, m/s$}
	\label{fig:bVSxy}
\end{figure}

The parameters $x^{\ast}_{SP}$ and $y^{\ast}_{SP}$ are the values, which minimize $F\left( x,y \right)$.  From this the source strength may be determined from \cref{eq:Tsp}.

\begin{equation}
\centering
\begin{split}
T^{\ast}_{SP} = \frac{1}{n} \{ \sum^{n}_{i=1} [ &m\left( x^{\ast}_{SP}+\Delta x_i, y^{\ast}_{SP}+\Delta y_i \right) T\left( x_i,y_i\right)   \\
	&  + b\left( x^{\ast}_{SP}+\Delta x_i, y^{\ast}_{SP}+\Delta y_i \right) ] \}
\label{eq:Tsp}
\end{split}
\end{equation}

The corrector half of the method assumes that the source strength predicted by \cref{eq:Tsp} is correct.  Modifying \cref{eq:F} with the new information results in \cref{eq:Fmod}.  The global minimum of $F_{mod}\left( x,y \right)$ occurs at $x_{SP}$ and $y_{SP}$.  The corrected source strength is calculated from \cref{eq:T} and its location is obtained as $-x_{SP},-y_{SP}$ from the datum data point.
%
\begin{equation}
\centering
\begin{split}
F_{mod}\left( x,y \right) = \sum^{n}_{i=1} [ &m\left( x+\Delta x_i, y+\Delta y_i \right) T\left( x_i,y_i\right) \\
 & + b\left( x+\Delta x_i, y+\Delta y_i \right)-T^{\ast}_{SP} ]^2
\label{eq:Fmod}
\end{split}
\end{equation}
%
\begin{equation}
\centering
\begin{split}
T_{SP} = \frac{1}{n} \{ \sum^{n}_{i=1} [ &m\left( x_{SP}+\Delta x_i, y_{SP}+\Delta y_i \right) T\left( x_i,y_i\right)   \\
	&  + b\left( x_{SP}+\Delta x_i, y_{SP}+\Delta y_i \right) ] \}
\label{eq:T}
\end{split}
\end{equation}
%
A simple flowchart of the major steps of the algorithm described in the preceeding is presented in \cref{fig:flowchart}.

\begin{figure}[!tbp]
\centering
\input{flowchart}
\caption{Flowchart of the presented methodology}
\label{fig:flowchart}
\end{figure}




\section{Results and discussions}

To separate experimental error from algorithm error, the method will initially only be applied to simulation results.  To further define how and where the error in predictions occur, a systematic set of test cases was performed.  Starting with the simplest case, where both horizontal source location $x_S$ and vertical source location $y_S$ are known a priori, and finishing with the most difficult, where none of the horizontal source location $x_S$, the vertical source location $y_S$, and the source temperature $T_S$ are known a priori.  It is worth noting only a small subset of performed numerical simulations and experimental results are presented in this study.

In the first test case, the predictor - corrector method is applied to the problem where both $x_S$ and $y_S$ are known.  Upon examining \cref{eq:linearset} or \cref{eq:linearset2} with fixed $x_S$ and $y_S$, it becomes obvious that, knowing the temperature at one location, results in a simplification of the predictor - corrector method to the exact solution of the inverse problem.  An example of a few test cases are shown in \cref{tab:typeA}.  The prediction error of source temperature of this inverse calculation is negligible for all cases within the plume.  This error is likely caused by neglecting variations in density and buoyancy, however this was not verified.  Alternative forms of error such as radiation were not yet considered due to the data sets compared are simulation results only.

The following, \cref{tab:typeA,tab:typeB,tab:typeC,tab:typeD,tab:typeE},  are similar and may be read as such.  Each column consists of a specified free stream velocity $U_{\infty}$ and a specified source temperature $T_S$.  Again, source temperature may be replaced with source heat flux.  Each row is labeled by a data sampling datum location ($x_S$, $y_S$), in millimeters.  As explained previously, the predictor phase uses three points arranged horizontally at and behind the datum location with $1.0\,mm$ spacing, and the corrector phase uses three points arranged vertically at and above the datum location with $1.0\,mm$ spacing.

\Cref{eq:error} is the means by which the error is calculated.  The constant parameters for the simulation tests are listed 

\begin{subequations}
\begin{align}
error_{temp} (\%) &= \frac{\left|T_{SP}-T_S\right| }{T_S-T_{\infty}} \times 100 \\
error_{x-location} (\%) &= \frac{\left|x_{SP}-x_S\right|}{x_S} \times 100 \\
error_{y-location} (\%) &= \frac{\left|y_{SP}-y_S\right|}{y_S} \times 100 
\end{align}
\label{eq:error}
\end{subequations}

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l | c c c c}
 $U_{\infty}$ $(m/s)$ & 0.6 & 0.6 & 1.0 & 1.0 \\ \hline
 $T_S$ $(K)$ & 375 & 425 & 375 & 425  \\ \hline \hline
 Location (x,y) & \\
 40 mm, 1 mm & $0.01\%$ & $0.01\%$ & $0.01\%$ & $0.02\%$ \\ \hline
 40 mm, 2 mm & $0.02\%$ & $0.01\%$ & $0.11\%$ & $0.19\%$ \\ \hline
 60 mm, 1 mm & $0.01\%$ & $0.01\%$ & $0.00\%$ & $0.00\%$ \\ \hline
 60 mm, 2 mm & $0.02\%$ & $0.02\%$ & $0.01\%$ & $0.03\%$ \\ \hline
 80 mm, 1 mm & $0.01\%$ & $0.01\%$ & $0.01\%$ & $0.01\%$ \\ \hline
 80 mm, 2 mm & $0.01\%$ & $0.01\%$ & $0.04\%$ & $0.07\%$ \\ \hline
 \end{tabular}
\caption{Error in the prediction of $T_S$ from several sampled cases within the plume with $x_S$ and $y_S$ known}
\label{tab:typeA}
\end{center}
\end{table}

The next type of problem has both the plume source strength and the elevation known.  That is to say both $T_S$ and $y_S$ are known a priori.  With the source strength known, the predictor - corrector method simplifies to just the corrector half of the method.  The prediction error of the $x_S$ location is small (shown in \cref{tab:typeB}), but not insignificant.  The error for this case is less than $1.0\%$ when testing within the plume.  This error is caused by again neglecting the variations in density and buoyancy, but also the random errors introduced by the genetic algorithm during the minimization process.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l | c c c c}
 $U_{\infty}$ $(m/s)$ & 0.6 & 0.6 & 1.0 & 1.0 \\ \hline
 $T_S$ $(K)$ & 375 & 425 & 375 & 425  \\ \hline \hline
 Location (x,y) & \\
 40 mm, 1 mm & $0.50\%$ & $0.28\%$ & $0.29\%$ & $0.01\%$ \\ \hline
 40 mm, 2 mm & $0.33\%$ & $0.31\%$ & $0.63\%$ & $0.09\%$ \\ \hline
 60 mm, 1 mm & $0.53\%$ & $0.29\%$ & $0.36\%$ & $0.08\%$ \\ \hline
 60 mm, 2 mm & $0.87\%$ & $0.47\%$ & $0.72\%$ & $0.23\%$ \\ \hline
 80 mm, 1 mm & $0.22\%$ & $0.13\%$ & $0.06\%$ & $0.03\%$ \\ \hline
 80 mm, 2 mm & $0.60\%$ & $0.40\%$ & $0.48\%$ & $0.11\%$ \\ \hline
 \end{tabular}
\caption{Error in the prediction of the horizontal location $x_S$ from several sampled cases within the plume with source temperature $T_S$ and $y_S$ known}
\label{tab:typeB}
\end{center}
\end{table}


The case where $T_S$ is known is very similar to the previous case, and also reduces to the corrector half.  The error here is identical to the previous case, that is the errors introduced by neglecting the variations in density and buoyancy, and random errors introduced by the genetic algorithm.  As one might expect the $x_S$ error for this case is similar to the previous one.  The $y_S$ error is larger, as expected.  The $y$ direction error calculation is more sensitive than that in the $x$ direction, as the values are numerically smaller.  Thus equivalent magnitude errors between $x_S$ and $y_S$ directions cause a more significant relative error in $y_S$.  The error of predicted $x_S$ and $y_S$ may be found in \cref{tab:typeC}.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l | l c c c c}
 $U_{\infty}$ $(m/s)$ & & 0.6 & 0.6 & 1.0 & 1.0 \\ \hline
 $T_S$ $(K)$ & & 375 & 425 & 375 & 425  \\ \hline \hline
 Location (x,y) & \\
 40 mm, 1 mm & X & $0.16\%$ & $0.06\%$ & $0.31\%$ & $0.08\%$ \\
 						 & Y & $5.53\%$ & $2.82\%$ & $2.72\%$ & $0.48\%$ \\ \hline
 40 mm, 2 mm & X & $0.26\%$ & $0.26\%$ & $0.14\%$ & $0.06\%$ \\ 
 						 & Y & $1.84\%$ & $0.67\%$ & $1.03\%$ & $0.08\%$ \\ \hline
 60 mm, 1 mm & X & $0.19\%$ & $0.15\%$ & $0.03\%$ & $0.09\%$ \\ 
						 & Y & $3.61\%$ & $1.62\%$ & $1.77\%$ & $0.08\%$ \\ \hline
 60 mm, 2 mm & X & $0.07\%$ & $0.01\%$ & $0.57\%$ & $0.57\%$ \\ 
   					 & Y & $2.39\%$ & $1.67\%$ & $2.02\%$ & $1.34\%$ \\ \hline
 80 mm, 1 mm & X & $0.00\%$ & $0.01\%$ & $0.12\%$ & $0.08\%$ \\ 
  					 & Y & $3.47\%$ & $1.85\%$ & $1.43\%$ & $0.33\%$ \\ \hline
 80 mm, 2 mm & X & $0.18\%$ & $0.18\%$ & $0.84\%$ & $0.82\%$ \\ 
 						 & Y & $2.37\%$ & $1.68\%$ & $2.35\%$ & $1.89\%$ \\ \hline
 \end{tabular}
\caption{Error in predicting $x_S$, $y_S$ from several sampled cases within the plume with $T_S$ known}
\label{tab:typeC}
\end{center}
\end{table}


The last case is where none of the $x_S$, $y_S$, and $T_S$ information is known a priori.  The error in this case is compounded between the three parameters.  Small errors in predicted source strength may yield large errors in location and vice-versa.  The results of $x_S$ and $y_S$ are similar to that found from the previous case, and results are shown in \cref{tab:typeD}.  The error in prediction of the source temperature is under $1.5\%$ in all sampled cases.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l | l c c c c}
 $U_{\infty}$ $(m/s)$ & & 0.6 & 0.6 & 1.0 & 1.0 \\ \hline
 $T_S$ $(K)$ & & 375 & 425 & 375 & 425  \\ \hline \hline
 Location (x,y) & \\
 40 mm, 1 mm & X & $0.28\%$ & $0.28\%$ & $0.37\%$ & $0.10\%$ \\
 						 & Y & $4.86\%$ & $4.86\%$ & $2.37\%$ & $0.42\%$ \\
 						 & T & $0.68\%$ & $0.78\%$ & $0.52\%$ & $0.07\%$ \\ \hline
 40 mm, 2 mm & X & $0.11\%$ & $0.11\%$ & $0.24\%$ & $0.04\%$ \\ 
 						 & Y & $1.06\%$ & $1.06\%$ & $0.77\%$ & $0.31\%$ \\ 
 						 & T & $1.08\%$ & $1.08\%$ & $0.85\%$ & $0.07\%$ \\ \hline
 60 mm, 1 mm & X & $0.01\%$ & $0.01\%$ & $0.09\%$ & $0.04\%$ \\ 
						 & Y & $3.93\%$ & $3.93\%$ & $1.69\%$ & $0.06\%$ \\ 
						 & T & $0.32\%$ & $0.32\%$ & $0.21\%$ & $0.05\%$ \\ \hline
 60 mm, 2 mm & X & $0.27\%$ & $0.27\%$ & $0.74\%$ & $0.59\%$ \\ 
   					 & Y & $2.26\%$ & $2.26\%$ & $1.89\%$ & $1.29\%$ \\ 
   					 & T & $0.67\%$ & $0.77\%$ & $0.69\%$ & $0.25\%$ \\ \hline
 80 mm, 1 mm & X & $0.07\%$ & $0.07\%$ & $0.12\%$ & $0.07\%$ \\ 
  					 & Y & $2.89\%$ & $2.89\%$ & $1.38\%$ & $0.35\%$ \\ 
  					 & T & $0.25\%$ & $0.25\%$ & $0.12\%$ & $0.00\%$ \\ \hline
 80 mm, 2 mm & X & $0.36\%$ & $0.36\%$ & $0.86\%$ & $0.73\%$ \\ 
 						 & Y & $2.19\%$ & $2.19\%$ & $2.34\%$ & $1.93\%$ \\ 
 						 & T & $0.46\%$ & $0.46\%$ & $0.33\%$ & $0.13\%$ \\ \hline
 \end{tabular}
\caption{Error in predicting $x_S$, $y_S$, $T_S$ from several sample cases within the plume}
\label{tab:typeD}
\end{center}
\end{table}

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l c}
\hline
Parameter & Value \\ \hline
$T_{\infty}\, (K)$ & $293$ \\
$P_{\infty}\, (kPa)$ & $101.32$ \\
$T_{SA},\, T_{SB}\, (K)$ & $350,\,450$ \\
n stage 1 & 3 \\
n stage 2 & 3 \\
$\delta x,\, \delta y $ stage 1 & $1.0\,mm,\,0.0\,mm$ \\
$\delta x,\, \delta y $ stage 2 & $0.0\,mm,\,1.0\,mm$ \\ \hline
 \end{tabular}
 \end{center}
\caption{Test parameters for the simulations}
\label{tab:simparam}
\end{table}


\subsection{Experimental Results}

An evaluation of the methodology against experimental data was performed, and the results are shown in \cref{tab:typeE}.  At first glance, the methodology does not appear to fare well with respsect to error, as compared to that for the simulation results.  The issue is the use of relative error versus absolute error.  In the numerical simulation tests use of relative error made the results clear.  In the case of the experiment, both absolute error and relative error give a misrepesentation of the results due to the large length scale in x compared to y.

The X-direction error for $x=40\, mm$ and $x=60\, mm$ never goes above $6.7\% $.  This is a reasonable expected error for the X-direction.  The Y-direction error for $x=40\, mm$ and $x=60\, mm$ never goes above $10\% $.  This seems a little high until you look at the absolute value of that error of $0.2\, mm$.  This error no longer seems to be a particularly large value when considering the lengths involved with the other direction.  The temperature error for $x=40\, mm$ and $x=60\, mm$, does not go above $5\% $ error.  This is very reasonable for the temperature prediction.

The problem arises when one starts looking at the errors for $x=80\, mm$.  The errors are very high.  This high error can easily be explained, looking back at \cref{fig:mVSxy,fig:bVSxy}.  In both cases, the curves asymptotically tend towards a single value, meaning the methodology will not be able to differentiate values far downstream.  This compounds with the natural experimental error, resulting in a finite distance down stream that this methodology is effective.  This distance is a function of both $U_{\infty}$ and $T_S$.  This makes sense from a turbulence stand point, since one would expect the flow field to eventually lead to uniform temperature.  As discussed previously $\frac{\partial m}{\partial x}$ and $\frac{\partial b}{\partial x}$ need to be large with respect to the magnitude of the error for the result to be essentially unique.  If the temperature is uniform then this is not the case and no unique solution can be found.

Some of the errors in this case must be from the simulation errors.  That is to say the simulations do not $100\%$ match the physical experimental data.  Some of the discrepancies may be explained by not simulating radiation, the inherent errors in the turbulence model, and difficulties simulating the transitional turbulence regime.

\begin{table}[!h!t!b!p]
\begin{center}
\begin{tabular}{ l | l c c c c}
 $U_{\infty}$ $(m/s)$ & & 0.6 & 0.6 & 1.0 & 1.0 \\ \hline
 $T_S$ $(K)$ & & 375 & 425 & 375 & 425  \\ \hline \hline
 Location (x,y) & \\
 40 mm, 1 mm & X & $0.0\%$ & $2.5\%$ & $5.0\%$ & $0.0\%$ \\
 						 & Y & $0.0\%$ & $10.\%$ & $2.0\%$ & $10.\%$ \\
 						 & T & $1.2\%$ & $1.8\%$ & $0.0\%$ & $1.1\%$ \\ \hline
 40 mm, 2 mm & X & $2.5\%$ & $2.5\%$ & $2.5\%$ & $2.5\%$ \\ 
 						 & Y & $10.\%$ & $10.\%$ & $10.\%$ & $5.0\%$ \\ 
 						 & T & $1.7\%$ & $2.0\%$ & $0.7\%$ & $1.9\%$ \\ \hline
 60 mm, 1 mm & X & $0.0\%$ & $3.3\%$ & $6.7\%$ & $0.0\%$ \\ 
						 & Y & $0.0\%$ & $8.0\%$ & $5.0\%$ & $2.0\%$ \\ 
						 & T & $1.1\%$ & $4.2\%$ & $3.3\%$ & $4.9\%$ \\ \hline
 60 mm, 2 mm & X & $6.7\%$ & $6.7\%$ & $3.7\%$ & $3.3\%$ \\ 
   					 & Y & $10.\%$ & $10.\%$ & $10.\%$ & $10.\%$ \\ 
   					 & T & $1.5\%$ & $4.9\%$ & $3.2\%$ & $3.2\%$ \\ \hline
 80 mm, 1 mm & X & $0.0\%$ & $7.5\%$ & $3.7\%$ & $0.0\%$ \\ 
  					 & Y & $1.0\%$ & $40.\%$ & $10.\%$ & $10.\%$ \\ 
  					 & T & $6.1\%$ & $38.\%$ & $54.\%$ & $32.\%$ \\ \hline
 80 mm, 2 mm & X & $5.0\%$ & $12.\%$ & $2.5\%$ & $1.2\%$ \\ 
 						 & Y & $25.\%$ & $35.\%$ & $10.\%$ & $5.0\%$ \\ 
 						 & T & $8.8\%$ & $29.\%$ & $41.\%$ & $54.\%$ \\ \hline
 \end{tabular}
\caption{Error in predicting $x_S$, $y_S$, $T_S$ from several sample cases within the plume}
\label{tab:typeE}
\end{center}
\end{table}


\section{Conclusions}

A predictor - corrector approach for solving inverse convection problems was developed and tested against both numerical and experimental results.  The method was developed starting with the previous work \cite{knight,rossmann} and employing sensitivity analysis of the problem.  

The results from all of the simulation tests show a relative source strength prediction error of less than $1\%$ in all cases tested within the plume.  The relative source location prediction error was less than $1\%$ for the free stream direction and less than $6\%$ for the direction perpendicular to the free stream.  Experimental tests indicate that the algorithm is only slightly less accurate, with the error increasing to $5\%$, for prediction of the source strength, and $5\%$ for prediction of the free stream coordinate location of the source.  The coordinate perpendicular to the free stream has an error of $10\%$.  While the $10\%$ seems significant the result in physical terms is only $0.2 \, mm$.

The predictor-corrector method lends itself to further investigations.  One major focus is the size and shape of the sampling patterns used.  Optimization of the sampling pattern would reduce the error associated with the method while keeping the number of samples to an absolute minimum.  Another focus is a full error analysis of the parameters.  The goal would be to develop a domain of error, a function to determine for what parameter values the methodology is within acceptable error.

The methodology could be useful in similar experimental cases, such as a jet in a crosswind or a plume with  crosswind.  If the methodology could be furthered to a more mature state (e.g. transient and three dimensional validation), it could be applicable in any number of inverse convection problems.  Examples of applications include fires in enclosures and/or urban environments\cite{hu}	, such as tunnels\cite{blanchard}, rooms, and buildings.

\appendix

\bibliography{Bibliography}{}
\bibliographystyle{model1-num-names}
\end{document}